---
# SPDX-License-Identifier: Apache-2.0
# Copyright Contributors to the ODPi Egeria project.

- name: ensure data file directory exists
  file:
    path: "{{ egeria_samples_cocopharma_targets.files }}"
    state: directory
    mode: 0755
    owner: "{{ ibm_infosvr_users.dsadm }}"
    group: "{{ ibm_infosvr_groups.dsadm }}"
  become: yes

- name: transfer sample data files
  copy:
    src: "data-files/"
    dest: "{{ egeria_samples_cocopharma_targets.files }}/"
    owner: "{{ ibm_infosvr_users.dsadm }}"
    group: "{{ ibm_infosvr_groups.dsadm }}"
    mode: 0644
  become: yes

- name: remove any non-sample files
  file:
    path: "{{ egeria_samples_cocopharma_targets.files }}/load.yml"
    state: absent
  become: yes

- import_role: name=IBM.infosvr-metadata-asset-manager
  vars:
    import_areas:
      - name: CocoPharma_SampleFiles
        type: LocalFileConnector
        description: "Loads metadata for CocoPharma sample files"
        metadata_interchange_server: "{{ groups['ibm-information-server-engine'][0] | lower }}"
        dcn:
          name: LOCALFS
        assets_to_import:
          - "folder[{{ egeria_samples_cocopharma_targets.files }}]"
        hostname: "{{ groups['ibm-information-server-engine'][0] | upper }}"
